# -*- coding: utf-8 -*-

# excel 列标题字段名称
TITLE_CALORIES      = '卡路里'
TITLE_TIMESTAMP     = '时间戳'
TITLE_TIMESTAMP_HEX     = '时间戳16进制'
TITLE_TIMESTAMP_END     = '结束时间戳'
TITLE_BASE_DT    = '基础时间'
TITLE_BASE_TIMESTAMP    = '基础时间戳'
TITLE_INC_TIMESTAMP     = '相对时间戳'
TITLE_DATETIME     = '时间'
TITILE_END_DATETIME = '结束时间'
TITLE_DIST          = '距离'
TITLE_HAS_SPORT     = '是否运动'
TITLE_HEIGHT        = '高度'
TITLE_STEP_NUM      = '步数'
TITLE_HR        = '心率'
TITLE_HR_MIN    = '最小心率'
TITLE_HR_MAX    = '最大心率'
TITLE_HR_REST   = '静息心率'
TITLE_HAS_SLEEP = '是否睡眠'
TITLE_SPO2      = '血氧'
TITLE_SPO2_GAP      = '测量间隔'
TITLE_STRESS    = '压力'
TITLE_STRESS_MIN    = '最小压力'
TITLE_STRESS_MAX    = '最大压力'
TITLE_QUALITY = '可信度'
TITLE_SPO2_QUALITY  =   '血氧可信度'
TITLE_STRESS_QUALITY    =   '压力可信度'
TITLE_HR_QUALITY    =   '心率可信度'
TITLE_HAS_EXERCISE  = '是否练习'
TITLE_ACTIVITY_TYPE = '运动类型'
TITLE_ACTIVITY_STATUS = '运动状态'
TITLE_TYPE = '类型'
TITLE_TYPE_NAME = '运动类型名称'
TITLE_EXERCISE     = '锻炼'
TITLE_SPORTID       = '运动记录ID'
TITLE_START_TIME    = '开始时间'
TITLE_END_TIME      = '结束时间'
TITLE_USED_TIME     = '总耗时'
TITLE_HEIGHT        = '高度'
TITLE_AVG_HR        = '平均心率'
TITLE_AVG_SPEED     = '平均速度'
TITLE_MAX_SPEED     = '最大速度'
TITLE_MAX_FREQ      = '最大步频'
TITLE_FINISHED_PERCENT  = '完成度'
TITLE_TIMEZONE      = '时区'
TITLE_EXTRA         = '附加数据'
TITLE_TRAINING_EFFECT   = '训练效果'
TITLE_RECOVERY_TIME     = '恢复时间'
TITLE_HRZONE        = '心率5区间'
TITLE_FIVEKMPLANS       = '5公里计划'
TITLE_KMPACE        = '每公里配速'
TITLE_FATTIME       = '减脂时长'
TITLE_STAMINA       = '体力'
TITLE_STAMINA_LEVEL = '体能等级'
TITLE_RECORD_LEV    = '运动等级'
TITLE_MAX_HR        = '最大心率'
TITLE_ELEVATION     = '海拔'
TITLE_FLOOR         = '爬楼'
TITLE_GPS           = 'GPS数据'
TITLE_GPS_DATETIME  = 'GPS时间'
TITLE_LATITUDE      = '精度'
TITLE_LONGTITUDE    = '纬度'
TITLE_GPS_SPEED     = 'GPS速度'
TITLE_STATE         = '状态'
TITLE_SPORT_DETAIL  = '运动详情数据'
TITLE_PACE          = '实时配速'
TITLE_FREQ          = '步频'
TITLE_LAP           = '总趟数'
TITLE_LAP_DETAIL    = '每趟耗时'
TITLE_STOKE         = '游泳划数'
TITLE_SWIM_TYPE     = '泳姿'
TITLE_POOL_LENGTH   = '泳池长度'
TITLE_SLEEP_STATUS  = '睡眠状态'
TITLE_SLEEP_START_INDEX = '睡眠开始索引'
TITLE_SLEEP_END_INDEX   =  '睡眠结束索引'
TITLE_SLEEP_SPO_MIN     = '睡眠最小血氧'
TITLE_SLEEP_SPO_MAX     = '睡眠最大血氧'
TITLE_VERSION           = '版本号'
TITLE_SPORT_TYPE        = '运动类型'
TITLE_HAS_DATA          = '是否有数据'
TITLE_SPO_TYPE     = '血氧类型'
TITLE_SPO_NORMAL    = '日常血氧'
TITLE_SPO_SLEEP     = '睡眠血氧'
TITLE_SPO_UNKNOWN   = '未知类型'
TITLE_SLEEP_DATA_LEN = '睡眠数据长度'
TITLE_WEAR = '是否佩戴'
TITLE_AUTOFLAG      = '自动运动检测'
TITLE_KMLEN         = '运动的整公里数'
TITLE_GAME_COUNTS   = '游戏轮数'
TITLE_GAME_STRESS   = '游戏压力'
TITLE_EP_FILENAME   = '埋点数据文件名'
TITLE_EP_SERVICEID  = '服务ID'
TITLE_EP_EVENTID    = '事件ID'
TITLE_EP_KEYID      = '关键字ID'
TITLE_EP_VALUE      = '具体内容'

# 每日活动记录前缀
DA_REC_OUT_FILENAME_PRE  = 'dailyActivity_rec_'

# 每日活动报告前缀
DA_RPT_OUT_FILENAME_PRE  = 'dailyActivity_rpt_'

# 睡眠数据前缀
SLEEP_OUT_FILENAME_PRE  = 'sleep_'

# 睡眠拉取临时文件前缀
SLEEP_TMP_OUT_FILENAME_PRE = 'sleep_tmp_'

# 运动记录前缀
SPORT_REC_OUT_FILENAME_PRE = 'sport_rec_'

# 游泳运动记录前缀
SWIM_REC_OUT_FILENAME_PRE = 'sport_swim_rec_'

# 运动记录索引前缀
SPORT_INDEX_OUT_FILENAME_PRE = 'sport_index_'

# 运动报告数据前缀
SPORT_RPT_OUT_FILENAME_PRE  = 'sport_rpt_'

# 运动记录拉取的临时文件
SPORT_REC_JSON_FILENAME_PRE = 'sport_rec_list_json_'

# 5分钟健身拉取的临时文件
FIVE_FITNESS_JSON_FILENAME_PRE  = 'fivemin_fitness_json_'

# 游泳运动报告数据前缀
SWIM_RPT_OUT_FILENAME_PRE  = 'sport_swim_rpt_'

# gps 打点数据前缀
SPORT_GPS_OUT_FILENAME_PRE  = 'sport_gps_'

# 血氧数据前缀
SPO_OUT_FILENAME_PRE  = 'spo_'

# 血氧前缀
SPO_INDEX_OUT_FILENAME_PRE  = 'spo_index_'

# 血氧前缀
SPO_TMP_OUT_FILENAME_PRE  = 'spo_tmp_'

# 心率临时文件前缀
HR_TMP_OUT_FILENAME_PRE  = 'hr_tmp_'

# 静息心率临时文件前缀
HR_RST_TMP_OUT_FILENAME_PRE  = 'hr_rst_tmp_'

# 每日活动临时文件前缀
DA_TMP_OUT_FILENAME_PRE  = 'da_tmp_'

# 压力临时文件前缀
STRESS_TMP_OUT_FILENAME_PRE  = 'stress_tmp_'

# 转换后输出文件的格式后缀
OUT_FILE_EXT    = '.csv'

KML_FILE_EXT    = '.kml'

# 埋点数据前缀
EP_DATA_FILENAME_PRE  = 'eventpoint_'

# 埋点数据前缀
EP_INDEX_FILENAME_PRE  = 'ep_index_'

# 定义转换的数据类型
TRANSLATE_TYPE_SPORT_REC = '1'
TRANSLATE_TYPE_SPORT_RPT = '2'
TRANSLATE_TYPE_SPORT_INDEX = '3'
TRANSLATE_TYPE_DA_REC    = '4'
TRANSLATE_TYPE_DA_RPT    = '5'
TRANSLATE_TYPE_SLEEP     = '6'
TRANSLATE_TYPE_SPO       = '7'
TRANSLATE_TYPE_SPO_INDEX = '8'
TRANSLATE_TYPE_HR_TMP    = '9'
TRANSLATE_TYPE_HR_REST_TMP  = '10'
TRANSLATE_TYPE_SLEEP_TMP    = '11'
TRANSLATE_TYPE_SPO_TMP      = '12'
TRANSLATE_TYPE_DA_TMP       = '13'
TRANSLATE_TYPE_SPORT_REC_TMP    = '14'
GENERATE_UUID               = '15'
TRANSLATE_TYPE_GPS2KML      = '16'
# gps 打点文件
TRANSLATE_TYPE_GPS          = '17'
# 游泳数据 打点文件\
TRANSLATE_TYPE_SWIM_RECORD  = '18'
# 游泳数据 报告文件
TRANSLATE_TYPE_SWIM_REPORT  = '19'
# 把数据文件转换为c数组， 写入手表中，进行模拟复测
CONVERT_TO_C_ARRAY          =  '20'
# 压力数据临时文件
TRANSLATE_TYPE_STRESS_TMP   = '21'

# 埋点索引文件
TRANSLATE_EVENTPOINT_INDEX  = '22'

# 埋点数据文件
TRANSLATE_EVENTPOINT_DATA  = '23'

# 串口通信的通用错误码
COM_ERROR_CODE_TIMEOUT  = '1'
COM_ERROR_CODE_UNKNOWN  = '2'
COM_ERROR_CODE_OK       = '3'

# 如果时间戳超过当前时间戳，则判定为异常，单独存储到一个文件
EXCEPTION_TIME_ERROR_EXT = '时间戳异常_'

# 转换后的文件单独放在一个目录
TRANSLATED_FILE_DIR     = '\\translated\\'

# 血氧数据格式
SPO_RECORD_ONE = '<2I2B2x'

# 血氧索引 数据格式
SPO_INDEX_RECORD_ONE = '<2IB3x'


# 运动报告第一段的struct参数
# version - autoflag 字段
SPORT_RECORD_PART_ONE = '<2H3IHB3x'

# per km time 数组
SPORT_RECORD_PART_TWO = '<150B2x'
SPORT_KM_TIME         = '<3B1x'

# per km len  - max heart rate
SPORT_RECORD_PART_THREE = '<2B2x1I4B'

SPORT_RECORD_PART_FOUR = '<1B3x3I1H4B2x5I1B1H1x2H3I2H1I1H2x2I3B1x'

SPORT_RECORD_PART_FIVE = '<2H3IHB3x'

# 运动记录的数据格式
# 非游泳运动
SPORT_REC_RECORD_ONE = '<1I4B1I3H2x2B2x'
# 游泳运动
SPORT_SWIM_RECORD_ONE = '<2I3B1x4H1B1x'


# 埋点数据格式
EVENTPOINT_RECORD_ONE = '<1I16s16s16s16s'

# 埋点索引 数据格式
EVENTPOINT_INDEX_RECORD_ONE = '<1I24s'

class byte_buffer_t:
    def __init__(self):
        self.offset = 0
        self.bookmark = 0
        self.size = 0
        self.limit = 0
        self.buf = []

def byte_buffer_reset(bytebufT):
    bytebufT.offset = 0
    bytebufT.bookmark = 0

def byte_buffer_create(bytebufT,buf,size):
    bytebufT.buf = buf
    bytebufT.size = size
    bytebufT.limit = 0
    bytebufT.bookmark = 0
    byte_buffer_reset(bytebufT)

def byte_buffer_move_short(bytebufT):
    bytebufT.offset = bytebufT.offset + 2

def byte_buffer_move_byte(bytebufT):
    bytebufT.offset = bytebufT.offset + 1

def byte_buffer_get_short(bytebufT,defaultValue):
    if bytebufT.offset + 2 <= bytebufT.size:
        result = bytebufT.buf[ bytebufT.offset ]
        bytebufT.offset = bytebufT.offset + 1
        result |= bytebufT.buf[ bytebufT.offset ] << 8
        bytebufT.offset = bytebufT.offset + 1
        return result
    return defaultValue

def byte_buffer_get_byte(bytebufT,defaultValue):
    if bytebufT.offset + 1 <= bytebufT.size:
        result = bytebufT.buf[ bytebufT.offset ]
        bytebufT.offset = bytebufT.offset + 1
        return result
    return defaultValue

def byte_buffer_get_bits_short(bytebufT,start,end,defaultValue):
    if bytebufT.offset + 2 <= bytebufT.size:
        mask = (0xffff<<start) & (0xffff>>(15-end))
        val = ( bytebufT.buf[ bytebufT.offset ] <<8 ) | bytebufT.buf[ bytebufT.offset +1 ]
        val = ( val & mask ) >> start
        return val
    return defaultValue

def byte_buffer_get_bits_byte(bytebufT,start,end,defaultValue):
    if bytebufT.offset + 1 <= bytebufT.size:
        mask = (0xff<<start) & (0xff>>(7-end))
        val = ( bytebufT.buf[ bytebufT.offset ] & mask ) >> start
        return val
    return defaultValue

def byte_buffer_get_int(bytebufT,defaultValue):
    if bytebufT.offset + 4 <= bytebufT.size:
        result = bytebufT.buf[ bytebufT.offset ]
        bytebufT.offset = bytebufT.offset + 1
        result = result | bytebufT.buf[bytebufT.offset]<<8
        bytebufT.offset = bytebufT.offset + 1
        result = result | bytebufT.buf[bytebufT.offset]<<16
        bytebufT.offset = bytebufT.offset + 1
        result = result | bytebufT.buf[bytebufT.offset]<<24
        bytebufT.offset = bytebufT.offset + 1

        return result
    return defaultValue


def byte_buffer_get_uint(bytebufT,defaultValue):
    if bytebufT.offset + 4 <= bytebufT.size:
        result = bytebufT.buf[ bytebufT.offset ]
        bytebufT.offset = bytebufT.offset + 1
        result = result | bytebufT.buf[bytebufT.offset]<<8
        bytebufT.offset = bytebufT.offset + 1
        result = result | bytebufT.buf[bytebufT.offset]<<16
        bytebufT.offset = bytebufT.offset + 1
        result = result | bytebufT.buf[bytebufT.offset]<<24
        bytebufT.offset = bytebufT.offset + 1

        return result
    return defaultValue

#  type:手表侧的类型定义
def getSportName(type):
    if type == 0:
        return "体能室外跑"
    elif type == 1:
        return "体能室内跑"
    elif type == 2:
        return "减脂跑室外"
    elif type == 3:
        return "减脂跑室内"
    elif type == 4:
        return "户外骑行"
    elif type == 5:
        return "户外骑行"
    elif type == 6:
        return "室内骑行"
    elif type == 7:
        return "泳池游泳"
    elif type == 8:
        return "登山"
    elif type == 9:
        return "越野"
    elif type == 10:
        return "板球"
    elif type == 11:
        return "瑜伽"
    elif type == 12:
        return "羽毛球"
    elif type == 13:
        return "划船机"
    elif type == 14:
        return "椭圆机"
    elif type == 15:
        return "自由训练"
    elif type == 16:
        return "训练助手"
    elif type == 17:
        return "5分钟健身"
    elif type == 18:
        return "马拉松"
    elif type == 19:
        return "快速体能测试"